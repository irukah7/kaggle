# Tabular Playground Series - Jun 2022
6月のPlaygroundシリーズは全てデータインピュテーション(代入法)についてです。代入法はデータ欠損値を代入して置き換える方法です。  
このデータセットは5月のPlaygroundに似ているが`target`がなくなっています。また、データセットには欠損値があるので、これらの値がどうあるべきか予測することです。
![](2022-06-01-17-54-02.png)

* 今月は欠損値を予測することが目的
* ノートブックの目的
    * データのインピュテーション(代入)

データセットが示唆するように、データには欠損値があり何らかの方法で欠損データをインピュテーションしなければならない。  
データセット内の欠損データを処理する方法はいくつかあり、簡単なインピュテーション方法を紹介したノートブックがたくさんある。
# Log

# 6/3

* データインピュテーション方法を説明したNotebook
    * https://www.kaggle.com/code/shtrausslearning/tps-model-based-imputation

このノートブックでは、異なるモデルのアンサンブルを含むモデルベースのインピュテーションのアプローチを見ていく。  
教師なし学習と教師あり学習の対象的なモデルを使用する。  
* データインピュテーションの種類
    (続きは後ほど記載)


# 6/4
* Discussion
    * https://www.kaggle.com/competitions/tabular-playground-series-jun-2022/discussion/328568
    * 様々なインピュテーションのテクニック
        * null値のある行を削除する
        * null度が高い特徴(カラム)を削除する
        * null値を平均値・中央値・その他の統計量に置換する
        * 半教師あり学習: 欠損データ代入問題の再定式化
        * 最尤推定量法
        * 多重代入法
        * ファンシーインピュテーション：MICE

# 6/5
* Disucussion
    * https://www.kaggle.com/competitions/tabular-playground-series-jun-2022/discussion/328369
    * 今回の課題はどのようなものか、どんな解決策が挙げられるか、コメントを通して探していくdiscussion

# 6/6
* 昨日のdiscussionの記事の続き
    * インピュテーションの方法として多くの有用な投稿が既にされている
    * インピュテーションのアプローチとは別に、これを回帰問題として扱い、それを解くというアプローチもある

回帰問題のアプローチでは一度に一つの列をターゲットとして考えて、他の列を使ってその列を予測しようとしている。  
たとえば、F_1_0列をターゲットとし、他の列を使ってこの列を予測するとする。欠損値は数値列にのみ存在するので予測するために回帰モデル構築する。各列について、その列の値が存在する全ての行を学習データセットとして、欠損列の値のテストデータセットとして取る事が出来る。`F_1_0`カラムのコード例は以下。
```python
df = pd.read_csv("/kaggle/input/tabular-playground-series-jun-2022/data.csv")
train_df = df[~df["F_1_0"].isna()]
test_df = df[df["F_1_0"].isna()]
```

そして訓練データを分割して回帰モデルを構築し評価できる。  
最終的に80のモデルを作成することになる。

# 6/7
* 欠損値を平均値で埋めてsubmitしてみる
    * 100万レコードある中で欠損値を埋める処理を実行しているので現在9時間半経過で6万7千件。。。。何日かかるのか。。
    * ![](2022-06-07-21-41-10.png)

# 6/8
* 昨日の100万レコードのデータ
    * 時間超過でsubmitできず
    * 約9万件読み込んで12時間でタイムアウト
    * ![](2022-06-08-09-07-15.png)
* 全てを平均値で代入したものを提出
    * 精度はだいぶ低い
    * ![](2022-06-08-23-17-14.png)

# 6/9
* 現在Most VotesであるNotebookosを見て日本語訳してみる
* オリジナル記事 >> https://www.kaggle.com/code/abdulravoofshaik/quick-eda-and-missing-values-tutorial
* 日本語訳 >> https://www.kaggle.com/hikarumoriya/quick-eda-and-missing-values-tutorial/edit

# 6/12
* 日本語訳完成 >> https://www.kaggle.com/hikarumoriya/quick-eda-and-missing-values-tutorial/edit

## 実装したい
* 目標： 欠損値に適切な値を入れる
* 方法: 線形回帰モデルを用いる
    * 本課題を回帰問題として扱い、それを解くアプローチをする
    * ex) F_1_0列をターゲットとし、他の列を使ってこの列を予測する